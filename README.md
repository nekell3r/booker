# Booker - –°–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–æ–≤

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–æ–ª–æ–≤ –Ω–∞ Go —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º gRPC, Kafka, Redis –∏ Postgres.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **admin-gateway**: REST API + —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- **venue-svc**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è–º–∏, –∑–∞–ª–∞–º–∏, —Å—Ç–æ–ª–∞–º–∏ –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
- **booking-svc**: –Ø–¥—Ä–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π —Å –º–∞—à–∏–Ω–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ Redis holds
- **notify-svc**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π

üìñ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ**: [ARCHITECTURE.md](ARCHITECTURE.md)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Docker** –∏ **Docker Compose**
- –ë–æ–ª—å—à–µ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ! –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

### –ó–∞–ø—É—Å–∫ (–≤—Å—ë –≤ –æ–¥–Ω–æ–º)

```bash
make setup
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å—Ç–∏—Ç –≤—Å—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Å–µ—Ä–≤–∏—Å—ã, –≤—ã–ø–æ–ª–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

### –ü–æ—à–∞–≥–æ–≤—ã–π –∑–∞–ø—É—Å–∫

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —Å–µ—Ä–≤–∏—Å—ã:
```bash
make up
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:
```bash
make migrate
```

3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
```bash
make seed
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: Proto —Ñ–∞–π–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ Docker –æ–±—Ä–∞–∑–æ–≤. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ: `make gen` (—Ç–æ–∂–µ —á–µ—Ä–µ–∑ Docker).

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –í—Å–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã (—Å–ª–µ–¥–∏—Ç—å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)
make logs

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å:
make logs-gateway    # admin-gateway
make logs-venue     # venue-svc
make logs-booking   # booking-svc
make logs-notify    # notify-svc

# –ß–µ—Ä–µ–∑ docker-compose:
docker-compose --profile apps logs -f admin-gateway
docker-compose --profile apps logs --tail=50 admin-gateway
docker-compose --profile apps logs --timestamps -f venue-svc
```

### –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

- Admin Gateway: http://localhost:18080
- Grafana: http://localhost:3000 (admin/admin)
- Jaeger: http://localhost:16686
- Prometheus: http://localhost:9090
- Kafka UI: http://localhost:18083

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îú‚îÄ‚îÄ admin-gateway/    # REST API + —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ venue-svc/         # –°–µ—Ä–≤–∏—Å –∑–∞–≤–µ–¥–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ booking-svc/       # –°–µ—Ä–≤–∏—Å –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ notify-svc/         # –°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îú‚îÄ‚îÄ proto/             # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ proto —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ kafka/             # Kafka producer/consumer
‚îÇ   ‚îú‚îÄ‚îÄ redis/             # Redis –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ tracing/           # OpenTelemetry —Ç—Ä–µ–π—Å–∏–Ω–≥
‚îú‚îÄ‚îÄ proto/                 # Proto –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
‚îú‚îÄ‚îÄ migrations/            # SQL –º–∏–≥—Ä–∞—Ü–∏–∏
‚îî‚îÄ‚îÄ deploy/                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```

## API

**–í–∞–∂–Ω–æ**: –í—Å–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π –∏–¥–µ—Ç —á–µ—Ä–µ–∑ **Admin Gateway** (–ø–æ—Ä—Ç 8080). 

`venue-svc` –∏ `booking-svc` - —ç—Ç–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ gRPC —Å–µ—Ä–≤–∏—Å—ã, –æ–Ω–∏ –Ω–µ –∏–º–µ—é—Ç REST API –Ω–∞–ø—Ä—è–º—É—é. Admin Gateway –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–¥–∏–Ω—ã–π REST API –∏ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º.

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± API
curl http://localhost:18080/api

# –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
curl -X POST http://localhost:18080/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "admin"}'
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

üìñ **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ API**: [API_USAGE.md](API_USAGE.md)

**–û—Å–Ω–æ–≤–Ω—ã–µ endpoints:**
- `/api/v1/venues` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è–º–∏
- `/api/v1/bookings` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è–º–∏
- `/api/v1/availability/check` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

### –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```bash
curl -X POST http://localhost:18080/api/v1/bookings \
  -H "Authorization: Bearer dummy-token" \
  -H "Content-Type: application/json" \
  -d '{
    "venue_id": "venue-1",
    "table": {
      "venue_id": "venue-1",
      "room_id": "room-1",
      "table_id": "table-1"
    },
    "slot": {
      "date": "2024-01-15",
      "start_time": "19:00",
      "duration_minutes": 120
    },
    "party_size": 4,
    "customer_name": "John Doe",
    "customer_phone": "+1234567890"
  }'
```

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è proto —Ñ–∞–π–ª–æ–≤

```bash
make gen
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
make test
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
make logs
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã (admin-gateway, venue-svc, booking-svc, notify-svc)
make restart

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
make restart-service SERVICE=admin-gateway
make restart-service SERVICE=venue-svc
make restart-service SERVICE=booking-svc
make restart-service SERVICE=notify-svc

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã (–≤–∫–ª—é—á–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É: postgres, redis, kafka –∏ —Ç.–¥.)
make restart-all

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞)
make rebuild-service SERVICE=admin-gateway
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
make down
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT


